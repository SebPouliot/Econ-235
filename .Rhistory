source('~/.active-rstudio-document', echo=TRUE)
knitr::opts_chunk$set(echo=FALSE, fig.keep='high', fig.width=6, fig.height=4, dev='cairo_pdf')
#Load some packages
library(pacman)
pacman::p_load(dplyr)
pacman::p_load(magrittr)
suppressMessages(pacman::p_load(reshape2))
pacman::p_load(Quandl)
suppressMessages(pacman::p_load(lubridate))
pacman::p_load(viridis)
pacman::p_load(Cairo)
#Authentification
Quandl.api_key("2xcmYFJoJKuEDwawuV7J")
#Basic setup for figures
source("Figures/Graph parameters.r")
download.file(https://www.raboag.com/mm/images/Corn-Basis-Map-800xNAug8.png, "Figures/")
download.file("https://www.raboag.com/mm/images/Corn-Basis-Map-800xNAug8.png", "Figures")
download.file("https://www.raboag.com/mm/images/Corn-Basis-Map-800xNAug8.png", "/Figures")
getwd()
download.file("https://www.raboag.com/mm/images/Corn-Basis-Map-800xNAug8.png", "/Figures/Basis_corn.png")
download.file("https://www.raboag.com/mm/images/Corn-Basis-Map-800xNAug8.png", "Figures/Basis_corn.png", method = "wget")
download.file("https://www.raboag.com/mm/images/Corn-Basis-Map-800xNAug8.png", "Figures/Basis_corn.png", method = "curl")
?knitr::include_graphics
hedging_futures <- function(f0, f1, b0, b1, cash.position){
#Long
if(cash.position == "long"){
tab <- data.frame(futures = c(f0, f1, f0-f1, NA, NA, NA, NA),
cash = c(f0 + b0, f1 + b1, (f1 + b1) - (f0 + b0), NA, NA, NA, NA),
basis = c(b0, b1, b1-b0, f0 + b0, (f1 + b1) - (f0 + b0), f0-f1, f0 + b1))
}
#Short
if(cash.position == "short"){
tab <- data.frame(futures = c(f0, f1, f1-f0, NA, NA, NA, NA),
cash = c(f0 + b0, f1 + b1, (f0 + b0) - (f1 + b1), NA, NA, NA, NA),
basis = c(b0, b1, b1-b0, f0 + b0, (f0 + b0) - (f1 + b1), f1-f0, f0 + b1))
}
rownames(tab) <- c("May price", "December price", "Gain/loss", "Cash price at beginning", "Gain from cash", "Gain from futures", "Net price")
return(tab)
}
hedging_futures(f0 = 5.5, f1 = 5, b0 = -0.75, b1 = -0.25, cash.position = "short")
dta = data.frame(array(NA, c(200,4)))
colnames(dta) <- c("price", "dbasis", "short", "long")
dta$dbasis <- seq(-0.99,1, 0.01)
dta$price <- 5.75
dta$short <- dta$price+dta$dbasis
dta$long <- dta$price+dta$dbasis
dta_graph <-  melt(dta[,c("price", "long", "short", "dbasis")], id="short")
colnames(dta_graph) <- c("price", "position", "gain")
dta_graph$position <- as.character(dta_graph$position)
dta_graph$position[dta_graph$position=="long"] <- "Long position"
dta_graph$position[dta_graph$position=="short"] <- "Short position"
dta_graph$position[dta_graph$position=="dbasis"] <- "Change in basis"
dbasis_plot <- ggplot(data = dta_graph[dta_graph$position=="Change in basis",], aes(x = gain, y = price, color = position)) + geom_hline(aes(yintercept=5.75), color="grey", size=0.5)
dbasis_plot
ggplot(data = dta_graph[dta_graph$position=="Change in basis",], aes(x = gain, y = price, color = position)) + geom_hline(aes(yintercept=5.75), color="grey", size=0.5) + geom_vline(aes(xintercept=0), color="grey", size=0.5) + geom_line(aes(linetype=position), size=0.5, color="blue") + ylab("Net price")  + xlab("Change in basis")
